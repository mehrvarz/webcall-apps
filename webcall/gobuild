# build script for webcall apps copyright 2023 timur.mobi
export BUILDDATE=`date --rfc-3339=date`
echo "builddate $BUILDDATE"
export VERSIONTAG=
if [[ -f ../.git/config ]]
then
  export VERSIONTAG=`git describe --tags --abbrev=0`
  echo "version ${VERSIONTAG##*$'\n'}" # last line of git tag
fi
foldername=${PWD##*/}
export GOARCH=386 && go build -ldflags "-s -w -X main.builddate=$BUILDDATE -X main.codetag=${VERSIONTAG##*$'\n'}" -o ../bin-linux-$GOARCH/$foldername
export GOARCH=amd64 && go build -ldflags "-s -w -X main.builddate=$BUILDDATE -X main.codetag=${VERSIONTAG##*$'\n'}" -o ../bin-linux-$GOARCH/$foldername

